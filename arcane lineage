local Hellish = loadstring(game:HttpGet("https://raw.githubusercontent.com/HellishHumanoid/hub/refs/heads/main/ui"))()

local Window = Hellish:CreateWindow({
   Name = "Hellish's AL",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "HellishArcane",
      FileName = "HellishShi"
   }
})

-- ============================================
-- MAIN SECTION
-- ============================================
local DodgeTab = Window:CreateTab("Main")
local DodgeSection = DodgeTab:CreateSection("Main Settings")

local AutoDodgeEnabled = false
local YellowDodgeDelay = 0
local RedDodgeDelay = 0
local EarlyOffset = 2

DodgeSection:CreateToggle({
   Name = "Auto-Dodge",
   Description = "Automatically dodge attacks",
   Default = false,
   Callback = function(Value)
      AutoDodgeEnabled = Value
   end,
})

local function checkIndicatorPosition()
   local success, result = pcall(function()
      local player = game:GetService("Players").LocalPlayer
      local combat = player.PlayerGui:FindFirstChild("Combat")
      
      if not combat then return nil end
      
      local block = combat:FindFirstChild("Block")
      if not block then return nil end
      
      if not block.Visible or block.AbsoluteSize.X == 0 then return nil end
      
      local inset = block:FindFirstChild("Inset")
      if not inset then return nil end
      
      if not inset.Visible or inset.AbsoluteSize.X == 0 then return nil end
      
      local indicator = inset:FindFirstChild("Indicator")
      local dodge = inset:FindFirstChild("Dodge")
      local block_area = inset:FindFirstChild("Block")
      
      if not indicator then return nil end
      
      if not indicator.Visible or indicator.AbsoluteSize.X == 0 then return nil end
      
      local indicatorLeft = indicator.AbsolutePosition.X
      local indicatorRight = indicatorLeft + indicator.AbsoluteSize.X
      local indicatorCenterX = indicatorLeft + (indicator.AbsoluteSize.X / 2)
      
      local hasVisibleDodge = dodge and dodge.Visible and dodge.AbsoluteSize.X > 0
      
      if hasVisibleDodge then
         local dodgeStart = dodge.AbsolutePosition.X
         local dodgeEnd = dodgeStart + dodge.AbsoluteSize.X
         local triggerPoint = dodgeStart - EarlyOffset
         
         if (indicatorCenterX >= triggerPoint and indicatorCenterX <= dodgeEnd) or
            (indicatorLeft >= triggerPoint and indicatorLeft <= dodgeEnd) or
            (indicatorRight >= triggerPoint and indicatorRight <= dodgeEnd) then
            return "yellow"
         end
      elseif block_area and block_area.Visible and block_area.AbsoluteSize.X > 0 then
         local blockStart = block_area.AbsolutePosition.X
         local blockEnd = blockStart + block_area.AbsoluteSize.X
         local triggerPoint = blockStart - EarlyOffset
         
         if (indicatorCenterX >= triggerPoint and indicatorCenterX <= blockEnd) or
            (indicatorLeft >= triggerPoint and indicatorLeft <= blockEnd) or
            (indicatorRight >= triggerPoint and indicatorRight <= blockEnd) then
            return "red"
         end
      end
      
      return nil
   end)
   
   return success and result or nil
end

local hasPressed = false
local lastIndicatorPos = nil
local pressedAt = 0
local lastAreaType = nil

game:GetService("RunService").RenderStepped:Connect(function()
   if not AutoDodgeEnabled then return end
   
   local success, currentCheck = pcall(function()
      local player = game:GetService("Players").LocalPlayer
      local combat = player.PlayerGui:FindFirstChild("Combat")
      if combat then
         local block = combat:FindFirstChild("Block")
         if block then
            local inset = block:FindFirstChild("Inset")
            if inset then
               local indicator = inset:FindFirstChild("Indicator")
               if indicator and indicator.Visible then
                  return indicator.AbsolutePosition.X
               end
            end
         end
      end
      return nil
   end)
   
   local currentIndicatorPos = success and currentCheck or nil
   local currentTime = tick()
   
   if lastIndicatorPos and currentIndicatorPos and currentIndicatorPos < lastIndicatorPos - 30 then
      hasPressed = false
      lastAreaType = nil
   end
   
   if hasPressed and (currentTime - pressedAt) > 0.4 then
      hasPressed = false
      lastAreaType = nil
   end
   
   lastIndicatorPos = currentIndicatorPos
   
   local areaType = checkIndicatorPosition()
   
   if areaType and not hasPressed then
      lastAreaType = areaType
      
      local delayToUse = (areaType == "yellow") and YellowDodgeDelay or RedDodgeDelay
      
      hasPressed = true
      pressedAt = currentTime
      
      task.spawn(function()
         if delayToUse > 0 then
            task.wait(delayToUse)
         end
         
         local VirtualInputManager = game:GetService("VirtualInputManager")
         VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Space, false, game)
         task.wait(0.05)
         VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Space, false, game)
      end)
   end
end)

-- ============================================
-- AUTO-LEVEL UP SECTION
-- ============================================
local AutoLevelUpEnabled = false
local isLevelingUp = false
local SelectedStats = {}

DodgeSection:CreateToggle({
   Name = "Auto-Level Up",
   Description = "Automatically level up selected stats",
   Default = false,
   Callback = function(Value)
      AutoLevelUpEnabled = Value
      if Value then
         task.spawn(autoLevelUpLoop)
      else
         isLevelingUp = false
      end
   end,
})

DodgeSection:CreateMultiDropdown({
   Name = "Select Stats to Level",
   Options = {"Strength", "Endurance", "Arcane", "Speed", "Luck"},
   Callback = function(Values)
      SelectedStats = Values
      print("Selected Stats:", table.concat(Values, ", "))
   end,
})

function autoLevelUpLoop()
    while AutoLevelUpEnabled do
        local player = game:GetService("Players").LocalPlayer
        local playerName = player.Name
        
        while AutoLevelUpEnabled do
            local living = workspace:FindFirstChild("Living")
            if living then
                local playerModel = living:FindFirstChild(playerName)
                if playerModel then
                    local fightInProgress = playerModel:FindFirstChild("FightInProgress")
                    if fightInProgress then
                        task.wait(2)
                    else
                        break
                    end
                else
                    break
                end
            else
                break
            end
        end
        
        if not AutoLevelUpEnabled then break end
        
        isLevelingUp = true
        
        local AutoAttackUserEnabled = _G.AutoAttackUserEnabled
        if AutoAttackUserEnabled then
            _G.AutoAttackEnabled = false
        end
        
        local GuiService = game:GetService("GuiService")
        local VIM = game:GetService("VirtualInputManager")
        
        if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
            task.wait(5)
            
            if AutoAttackUserEnabled then
                _G.AutoAttackEnabled = true
            end
            
            isLevelingUp = false
            
            local waitTime = 300
            local waitStart = tick()
            while AutoLevelUpEnabled and (tick() - waitStart) < waitTime do
                task.wait(1)
            end
            continue
        end
        
        local originalPosition = player.Character.HumanoidRootPart.CFrame
        
        local promptTriggered = false
        local startTime = tick()
        local duration = 2
        
        while not promptTriggered and (tick() - startTime) < duration do
            for i = 1, 3 do
                if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                    player.Character.HumanoidRootPart.CFrame = CFrame.new(790, 235, 2117)
                end
                
                task.wait(0.01)
                
                VIM:SendKeyEvent(true, Enum.KeyCode.E, false, game)
                task.wait(0.01)
                VIM:SendKeyEvent(false, Enum.KeyCode.E, false, game)
                
                task.wait(0.01)
            end
            
            local dialogue = player.PlayerGui:FindFirstChild("NPCDialogue")
            if dialogue and dialogue:FindFirstChild("BG") and dialogue.BG.Visible then
                promptTriggered = true
            end
        end
        
        if promptTriggered then
            task.wait(1)
            player.Character.HumanoidRootPart.CFrame = originalPosition
            
            local dialogue = player.PlayerGui:WaitForChild("NPCDialogue")
            local bg = dialogue:WaitForChild("BG")
            local options = bg:WaitForChild("Options")
            
            task.wait(0.5)
            
            local allChildren = options:GetChildren()
            local thirdOption = allChildren[3]
            
            if thirdOption then
                GuiService.GuiNavigationEnabled = true
                
                GuiService.SelectedObject = thirdOption
                task.wait(0.3)
                
                VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                task.wait(0.05)
                VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
                
                task.wait(8)
                
                local levelUp = player.PlayerGui:FindFirstChild("LevelUp")
                if levelUp and levelUp:FindFirstChild("Container") then
                    local buttons = levelUp.Container.Body.Buttons
                    
                    -- Map of stat names to their buttons
                    local statButtons = {
                        Strength = buttons.Strength.Frame.StrengthUp,
                        Endurance = buttons.Endurance.Frame.EnduranceUp,
                        Arcane = buttons.Arcane.Frame.ArcaneUp,
                        Speed = buttons.Speed.Frame.SpeedUp,
                        Luck = buttons.Luck.Frame.LuckUp
                    }
                    
                    -- Level up each selected stat 5 times
                    for _, statName in pairs(SelectedStats) do
                        local statButton = statButtons[statName]
                        if statButton then
                            print("Leveling up", statName, "5 times")
                            for i = 1, 5 do
                                GuiService.SelectedObject = statButton
                                task.wait(0.3)
                                
                                VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                                task.wait(0.05)
                                VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
                                
                                task.wait(0.3)
                                print("Click", i, "for", statName)
                            end
                        end
                    end
                    
                    local finishButton = levelUp.Finish
                    
                    task.wait(0.3)
                    GuiService.SelectedObject = finishButton
                    task.wait(0.2)
                    
                    VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                    task.wait(0.02)
                    VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
                    
                    task.wait(0.2)
                    
                    GuiService.GuiNavigationEnabled = false
                    GuiService.SelectedObject = nil
                end
            end
        end
        
        if AutoAttackUserEnabled then
            _G.AutoAttackEnabled = true
        end
        
        isLevelingUp = false
        
        local waitTime = 300
        local waitStart = tick()
        
        while AutoLevelUpEnabled and (tick() - waitStart) < waitTime do
            task.wait(1)
        end
        
        if not AutoLevelUpEnabled then
            break
        end
    end
    
    isLevelingUp = false
end

-- ============================================
-- AUTO-ATTACK SECTION
-- ============================================
_G.AutoAttackEnabled = false
local SelectedSkill = "Strike"
_G.AutoAttackUserEnabled = false

local AttackSection = DodgeTab:CreateSection("Attack Settings")

AttackSection:CreateToggle({
   Name = "Auto-Attack",
   Description = "Automatically attack enemies",
   Default = false,
   Callback = function(Value)
      _G.AutoAttackUserEnabled = Value
      _G.AutoAttackEnabled = Value
   end,
})

AttackSection:CreateDropdown({
   Name = "Select Skill",
   Options = {"Strike"},
   Callback = function(Value)
      SelectedSkill = Value
   end,
})

AttackSection:CreateButton({
   Name = "Refresh Skills",
   Callback = function()
      local player = game:GetService("Players").LocalPlayer
      local success, skills = pcall(function()
         local scrollFrame = player.PlayerGui.Combat.ActionBG.AttacksPage.Attack.ScrollingFrame
         local skillList = {}
         
         for _, child in pairs(scrollFrame:GetChildren()) do
            if child:IsA("TextButton") or (child:IsA("Frame") and child:FindFirstChild("TextLabel")) then
               table.insert(skillList, child.Name)
            end
         end
         
         return skillList
      end)
      
      if success and #skills > 0 then
         print("Skills refreshed:", table.concat(skills, ", "))
         SelectedSkill = skills[1]
      end
   end,
})

local UtilitySection = DodgeTab:CreateSection("Utility")

UtilitySection:CreateButton({
   Name = "Teleport to ???",
   Callback = function()
      local player = game:GetService("Players").LocalPlayer
      
      if player.Character then
         local humanoidRootPart = player.Character:FindFirstChild("HumanoidRootPart")
         if humanoidRootPart then
            humanoidRootPart.CFrame = CFrame.new(790, 235, 2117)
         end
      end
   end,
})

UtilitySection:CreateButton({
   Name = "Reset",
   Callback = function()
      local player = game:GetService("Players").LocalPlayer
      local TeleportService = game:GetService("TeleportService")
      
      if player.Character then
         local humanoid = player.Character:FindFirstChild("Humanoid")
         if humanoid then
            humanoid.Health = 0
         end
      end
      
      task.wait(0.5)
      
      TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId, player)
   end,
})

local isAttacking = false
local lastActionBGState = false

local function performAutoAttack()
   if isAttacking then return false end
   isAttacking = true
   
   local GuiService = game:GetService("GuiService")
   local UserInputService = game:GetService("UserInputService")
   local VIM = game:GetService("VirtualInputManager")
   
   local player = game:GetService("Players").LocalPlayer
   local actionBG = player.PlayerGui.Combat.ActionBG
   local attackButton = actionBG.ContextPage.AttackButton
   
   GuiService.GuiNavigationEnabled = true
   UserInputService.MouseIconEnabled = false
   
   task.wait(0.3)
   
   local attackAttempts = 0
   while actionBG.Visible and not actionBG.AttacksPage.Visible and attackAttempts < 5 do
      GuiService.SelectedObject = attackButton
      task.wait(0.3)
      
      VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
      task.wait(0.05)
      VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
      
      task.wait(0.5)
      attackAttempts = attackAttempts + 1
   end
   
   if not actionBG.Visible or not actionBG.AttacksPage.Visible then
      GuiService.GuiNavigationEnabled = false
      GuiService.SelectedObject = nil
      UserInputService.MouseIconEnabled = true
      isAttacking = false
      return
   end
   
   local skillButton = actionBG.AttacksPage.Attack.ScrollingFrame:FindFirstChild(SelectedSkill)
   
   if not skillButton then
      GuiService.GuiNavigationEnabled = false
      GuiService.SelectedObject = nil
      UserInputService.MouseIconEnabled = true
      isAttacking = false
      return
   end
   
   local skillAttempts = 0
   local enemiesVisible = false
   
   while actionBG.Visible and not enemiesVisible and skillAttempts < 5 do
      GuiService.SelectedObject = skillButton
      task.wait(0.3)
      
      VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
      task.wait(0.05)
      VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
      
      task.wait(0.5)
      
      local enemiesScroll = actionBG.AttacksPage.Enemies.ScrollingFrame
      for _, child in pairs(enemiesScroll:GetChildren()) do
         if child:IsA("GuiObject") and not child:IsA("UIListLayout") and not child:IsA("UIPadding") then
            enemiesVisible = true
            break
         end
      end
      
      skillAttempts = skillAttempts + 1
   end
   
   if not actionBG.Visible or not enemiesVisible then
      GuiService.GuiNavigationEnabled = false
      GuiService.SelectedObject = nil
      UserInputService.MouseIconEnabled = true
      isAttacking = false
      return
   end
   
   local enemiesScroll = actionBG.AttacksPage.Enemies.ScrollingFrame
   local firstEnemy = nil
   
   for _, child in pairs(enemiesScroll:GetChildren()) do
      if child:IsA("GuiObject") and not child:IsA("UIListLayout") and not child:IsA("UIPadding") then
         firstEnemy = child
         break
      end
   end
   
   if not firstEnemy then
      GuiService.GuiNavigationEnabled = false
      GuiService.SelectedObject = nil
      UserInputService.MouseIconEnabled = true
      isAttacking = false
      return
   end
   
   local enemyAttempts = 0
   while actionBG.Visible and enemyAttempts < 10 do
      GuiService.SelectedObject = firstEnemy
      task.wait(0.3)
      
      VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
      task.wait(0.05)
      VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
      
      task.wait(0.5)
      enemyAttempts = enemyAttempts + 1
   end
   
   GuiService.GuiNavigationEnabled = false
   GuiService.SelectedObject = nil
   UserInputService.MouseIconEnabled = true
   
   isAttacking = false
   return true
end

task.spawn(function()
   local player = game:GetService("Players").LocalPlayer
   local combat = player.PlayerGui:WaitForChild("Combat")
   local actionBG = combat:WaitForChild("ActionBG")
   
   while true do
      task.wait(0.1)
      
      if _G.AutoAttackEnabled and not isLevelingUp then
         local currentState = actionBG.Visible
         
         if currentState and not lastActionBGState and not isAttacking then
            task.wait(0.5)
            performAutoAttack()
         end
         
         lastActionBGState = currentState
      else
         lastActionBGState = false
      end
   end
end)

-- ============================================
-- AUTO-ITEM SECTION
-- ============================================
local FarmTab = Window:CreateTab("Items")
local ItemSection = FarmTab:CreateSection("Item Collection")

local AutoItemEnabled = false
local ItemSettings = {
    Everthistle = false,
    Hightail = false,
    Carnastool = false,
    Crylight = false,
    Cryastem = false,
    Driproot = false,
    ["7 Leafed Everthistle"] = false
}
local MoveSpeed = 300

local function setNoclip(enabled)
    local player = game:GetService("Players").LocalPlayer
    local character = player.Character
    if not character then return end
    
    for _, part in pairs(character:GetDescendants()) do
        if part:IsA("BasePart") then
            part.CanCollide = not enabled
        end
    end
end

local function smoothTeleportTo(targetPosition)
    local player = game:GetService("Players").LocalPlayer
    local character = player.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then return false end
    
    local hrp = character.HumanoidRootPart
    local startPos = hrp.Position
    local distance = (targetPosition - startPos).Magnitude
    local duration = distance / MoveSpeed
    local startTime = tick()
    
    setNoclip(true)
    
    while tick() - startTime < duration and AutoItemEnabled do
        local alpha = (tick() - startTime) / duration
        alpha = math.min(alpha, 1)
        
        local newPos = startPos:Lerp(targetPosition, alpha)
        hrp.CFrame = CFrame.new(newPos)
        
        task.wait()
    end
    
    if AutoItemEnabled then
        hrp.CFrame = CFrame.new(targetPosition)
    end
    
    return true
end

local function collectItem(itemModel)
    local handle = itemModel:FindFirstChild("Handle")
    if not handle then return false end
    
    local clickPart = handle:FindFirstChild("ClickPart")
    if not clickPart then return false end
    
    local targetPos = clickPart.Position + Vector3.new(0, 5, 0)
    local success = smoothTeleportTo(targetPos)
    
    if success and AutoItemEnabled then
        task.wait(0.3)
        AutoItemEnabled = false
        setNoclip(false)
        return true
    end
    
    return false
end

local function autoCollectItems()
    while AutoItemEnabled do
        local spawnedItems = workspace:FindFirstChild("SpawnedItems")
        
        if spawnedItems then
            for _, item in pairs(spawnedItems:GetChildren()) do
                if not AutoItemEnabled then break end
                
                if item:IsA("Model") then
                    local itemName = item.Name
                    
                    if ItemSettings[itemName] then
                        collectItem(item)
                        return
                    end
                end
            end
            
            task.wait(2)
        else
            task.wait(2)
        end
    end
    
    setNoclip(false)
end

ItemSection:CreateButton({
    Name = "Teleport to Item",
    Callback = function()
        if not AutoItemEnabled then
            AutoItemEnabled = true
            task.spawn(autoCollectItems)
        end
    end,
})

local ItemTypesSection = FarmTab:CreateSection("Item Types")

local SelectedItem = nil

ItemTypesSection:CreateDropdown({
    Name = "Select Item",
    Options = {"Everthistle", "Hightail", "Carnastool", "Crylight", "Cryastem", "Driproot", "7 Leafed Everthistle"},
    Callback = function(Value)
        -- Clear all previous selections
        for key in pairs(ItemSettings) do
            ItemSettings[key] = false
        end
        
        -- Set the newly selected item
        if Value then
            SelectedItem = Value
            ItemSettings[Value] = true
            print("Selected Item:", Value)
        end
    end,
})

task.spawn(function()
    while true do
        task.wait(0.5)
        if AutoItemEnabled then
            setNoclip(true)
        end
    end
end)

-- ============================================
-- MISC TAB
-- ============================================
local MiscTab = Window:CreateTab("Misc")
local MiscSection = MiscTab:CreateSection("Settings")

MiscSection:CreateKeybind({
    Name = "Toggle UI",
    Default = Enum.KeyCode.RightShift,
    Callback = function(Key)
        print("UI Toggle Key Pressed:", Key.Name)
    end
})

print("ðŸ”¥ Hellish's Arcane Lineage Loaded Successfully!")
