local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Rafso Car Zone",
    LoadingTitle = "Crazy",
    LoadingSubtitle = "by Rafso",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = nil,
        FileName = "AutoRace"
    },
    Discord = {
        Enabled = false
    },
    KeySystem = false
})

local MainTab = Window:CreateTab("Main", 4483362458)
local ESPTab = Window:CreateTab("ESP", 4483362458)

-- Variables
local autoRaceEnabled = false
local autoBeamrushEnabled = false
local autoPresentEnabled = false
local espEnabled = false
local player = game.Players.LocalPlayer
local espObjects = {}
local tweenSpeed = 100 -- Default tween speed
local vehicleNoclipEnabled = false

-- ==================== ANTI-AFK SYSTEM ====================
local antiAFKRunning = false

local function startAntiAFK()
    if antiAFKRunning then return end
    antiAFKRunning = true
    
    task.spawn(function()
        local VIM = game:GetService("VirtualInputManager")
        
        while antiAFKRunning do
            task.wait(300)
            VIM:SendMouseButtonEvent(0, 0, 0, true, game, 1)
            task.wait(0.1)
            VIM:SendMouseButtonEvent(0, 0, 0, false, game, 1)
            print("Anti-AFK: Click sent")
        end
    end)
    
    print("Anti-AFK: Started")
end

startAntiAFK()

-- ==================== GARAGE CLEANUP ====================
local function cleanupGarage()
    local garage = workspace:FindFirstChild("Garage")
    if garage then
        local garageModel = garage:FindFirstChild("Garage")
        if garageModel then
            print("Cleaning up Garage model...")
            local count = 0
            for _, child in pairs(garageModel:GetChildren()) do
                if child.Name ~= "Area" then
                    child:Destroy()
                    count = count + 1
                end
            end
            print("Deleted " .. count .. " objects from Garage (kept Area)")
        else
            warn("Garage.Garage not found!")
        end
    else
        warn("workspace.Garage not found!")
    end
end

-- Run garage cleanup when script loads
cleanupGarage()

-- ==================== ESP CONFIGURATION ====================
local ESP_CONFIG = {
    Normal = {
        BoxColor = Color3.fromRGB(255, 0, 0),
        TextColor = Color3.fromRGB(255, 100, 100),
        Name = "Present"
    },
    Golden = {
        BoxColor = Color3.fromRGB(255, 215, 0),
        TextColor = Color3.fromRGB(255, 255, 100),
        Name = "Golden Present"
    }
}

local function createESP(presentModel, isGolden)
    if espObjects[presentModel] then return end
    
    local config = isGolden and ESP_CONFIG.Golden or ESP_CONFIG.Normal
    
    local billboardGui = Instance.new("BillboardGui")
    billboardGui.Name = "PresentESP"
    billboardGui.AlwaysOnTop = true
    billboardGui.Size = UDim2.new(0, 200, 0, 50)
    billboardGui.StudsOffset = Vector3.new(0, 3, 0)
    billboardGui.Adornee = presentModel.PrimaryPart or presentModel:FindFirstChildWhichIsA("BasePart")
    
    if not billboardGui.Adornee then
        billboardGui:Destroy()
        return
    end
    
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.new(1, 0, 1, 0)
    textLabel.BackgroundTransparency = 1
    textLabel.Text = config.Name
    textLabel.TextColor3 = config.TextColor
    textLabel.TextSize = 34
    textLabel.Font = Enum.Font.GothamBold
    textLabel.TextStrokeTransparency = 0.5
    textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
    textLabel.Parent = billboardGui
    
    local fontFace = Font.new(
        "rbxasset://fonts/families/GothamSSm.json",
        Enum.FontWeight.SemiBold,
        Enum.FontStyle.Italic
    )
    textLabel.FontFace = fontFace
    
    billboardGui.Parent = game.CoreGui
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "PresentHighlight"
    highlight.FillColor = config.BoxColor
    highlight.FillTransparency = 0.5
    highlight.OutlineColor = config.BoxColor
    highlight.OutlineTransparency = 0
    highlight.Adornee = presentModel
    highlight.Parent = game.CoreGui
    
    espObjects[presentModel] = {
        Billboard = billboardGui,
        Highlight = highlight
    }
end

local function removeESP(presentModel)
    if espObjects[presentModel] then
        if espObjects[presentModel].Billboard then
            espObjects[presentModel].Billboard:Destroy()
        end
        if espObjects[presentModel].Highlight then
            espObjects[presentModel].Highlight:Destroy()
        end
        espObjects[presentModel] = nil
    end
end

local function clearAllESP()
    for presentModel, espData in pairs(espObjects) do
        if espData.Billboard then
            espData.Billboard:Destroy()
        end
        if espData.Highlight then
            espData.Highlight:Destroy()
        end
    end
    espObjects = {}
end

local function updateESP()
    if not espEnabled then
        clearAllESP()
        return
    end
    
    local pumpkinsFolder = workspace:FindFirstChild("Pumpkins")
    local goldenPumpkinsFolder = workspace:FindFirstChild("PumpkinsGolden")
    local existingPresents = {}
    
    if pumpkinsFolder then
        for _, model in pairs(pumpkinsFolder:GetChildren()) do
            if model:IsA("Model") then
                existingPresents[model] = true
                if not espObjects[model] then
                    createESP(model, false)
                end
            end
        end
    end
    
    if goldenPumpkinsFolder then
        for _, model in pairs(goldenPumpkinsFolder:GetChildren()) do
            if model:IsA("Model") then
                existingPresents[model] = true
                if not espObjects[model] then
                    createESP(model, true)
                end
            end
        end
    end
    
    for presentModel, _ in pairs(espObjects) do
        if not existingPresents[presentModel] then
            removeESP(presentModel)
        end
    end
end

spawn(function()
    while true do
        if espEnabled then
            updateESP()
        end
        wait(0.5)
    end
end)

local function setupFolderListener(folder, isGolden)
    if not folder then return end
    
    folder.ChildAdded:Connect(function(child)
        if espEnabled and child:IsA("Model") then
            wait(0.1)
            createESP(child, isGolden)
        end
    end)
    
    folder.ChildRemoved:Connect(function(child)
        if child:IsA("Model") then
            removeESP(child)
        end
    end)
end

local pumpkinsFolder = workspace:FindFirstChild("Pumpkins")
local goldenPumpkinsFolder = workspace:FindFirstChild("PumpkinsGolden")

if pumpkinsFolder then
    setupFolderListener(pumpkinsFolder, false)
end

if goldenPumpkinsFolder then
    setupFolderListener(goldenPumpkinsFolder, true)
end

workspace.ChildAdded:Connect(function(child)
    if child.Name == "Pumpkins" then
        setupFolderListener(child, false)
    elseif child.Name == "PumpkinsGolden" then
        setupFolderListener(child, true)
    end
end)

local ESPToggle = ESPTab:CreateToggle({
    Name = "Present ESP",
    CurrentValue = false,
    Flag = "PresentESPToggle",
    Callback = function(Value)
        espEnabled = Value
        if Value then
            print("Present ESP enabled!")
            updateESP()
        else
            print("Present ESP disabled!")
            clearAllESP()
        end
    end,
})

-- ==================== VEHICLE FUNCTIONS ====================
local function getVehicle()
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid and humanoid.SeatPart then
        return humanoid.SeatPart.Parent
    end
    return nil
end

local function teleportVehicleToCheckpoint(checkpointPosition)
    local vehicle = getVehicle()
    
    if not vehicle then
        warn("You are not in a vehicle!")
        return false
    end
    
    local vehicleRoot = vehicle.PrimaryPart or vehicle:FindFirstChild("VehicleSeat") or vehicle:FindFirstChildWhichIsA("VehicleSeat")
    
    if not vehicleRoot then
        warn("Could not find vehicle's primary part!")
        return false
    end
    
    local partsToUnanchor = {}
    for _, part in pairs(vehicle:GetDescendants()) do
        if part:IsA("BasePart") and not part.Anchored then
            part.Anchored = true
            table.insert(partsToUnanchor, part)
            part.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
            part.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
        end
    end
    
    local currentCFrame = vehicleRoot.CFrame
    local offset = currentCFrame - currentCFrame.Position
    vehicle:SetPrimaryPartCFrame(CFrame.new(checkpointPosition) * offset)
    
    wait(0.05)
    for _, part in pairs(partsToUnanchor) do
        part.Anchored = false
    end
    
    return true
end

-- Simple stable vehicle movement with noclip
local function moveVehicleToPosition(targetPosition, speed)
    local vehicle = getVehicle()
    if not vehicle then
        warn("Not in vehicle!")
        return false
    end
    
    if not vehicle.PrimaryPart then
        local seat = vehicle:FindFirstChild("VehicleSeat") or vehicle:FindFirstChildWhichIsA("VehicleSeat")
        if seat then
            vehicle.PrimaryPart = seat
        end
    end
    
    local root = vehicle.PrimaryPart
    if not root then
        warn("No primary part!")
        return false
    end
    
    -- Store offsets and identify wheels
    local offsets = {}
    local wheels = {}
    for _, part in pairs(vehicle:GetDescendants()) do
        if part:IsA("BasePart") then
            offsets[part] = root.CFrame:ToObjectSpace(part.CFrame)
            -- Identify wheels more comprehensively
            if part.Name:lower():match("wheel") or 
               part.Name:lower():match("tire") or 
               part.Shape == Enum.PartType.Cylinder or
               part.Shape == Enum.PartType.Ball then
                wheels[part] = true
            end
        end
    end
    
    local start = root.Position
    local distance = (targetPosition - start).Magnitude
    local duration = distance / speed
    local startTime = tick()
    
    -- Movement loop
    while true do
        if not autoBeamrushEnabled then break end
        
        local elapsed = tick() - startTime
        local alpha = math.min(elapsed / duration, 1)
        
        -- Interpolate
        local currentPos = start:Lerp(targetPosition, alpha)
        local dir = (targetPosition - start).Unit
        
        -- Set position with velocity
        root.CFrame = CFrame.new(currentPos, currentPos + dir)
        root.AssemblyLinearVelocity = dir * speed
        
        -- Update all parts
        for part, offset in pairs(offsets) do
            if part ~= root and part.Parent then
                -- Force exact CFrame position to prevent drift
                part.CFrame = root.CFrame:ToWorldSpace(offset)
                
                if wheels[part] then
                    -- Completely lock wheels - no velocity, no rotation
                    part.AssemblyLinearVelocity = Vector3.zero
                    part.AssemblyAngularVelocity = Vector3.zero
                    part.RotVelocity = Vector3.zero
                else
                    -- Non-wheels get normal velocity
                    part.AssemblyLinearVelocity = dir * speed
                end
            end
        end
        
        if alpha >= 1 then break end
        task.wait()
    end
    
    -- Stop all movement
    for part in pairs(offsets) do
        if part.Parent then
            part.AssemblyLinearVelocity = Vector3.zero
            part.AssemblyAngularVelocity = Vector3.zero
            part.RotVelocity = Vector3.zero
        end
    end
    
    return true
end

-- ==================== AUTO-RACE ====================
local function startAutoRace()
    local checkpointsFolder = workspace:FindFirstChild("Around The World")
    if not checkpointsFolder then
        warn("Could not find 'Around The World' folder!")
        return
    end
    
    checkpointsFolder = checkpointsFolder:FindFirstChild("Checkpoints")
    if not checkpointsFolder then
        warn("Could not find 'Checkpoints' folder!")
        return
    end
    
    local checkpoints = {}
    for _, checkpoint in pairs(checkpointsFolder:GetChildren()) do
        if checkpoint.Name:match("Checkpoint%d+") then
            local number = tonumber(checkpoint.Name:match("%d+"))
            if number then
                checkpoints[number] = checkpoint
            end
        end
    end
    
    while autoRaceEnabled do
        print("Teleporting to starting position...")
        teleportVehicleToCheckpoint(Vector3.new(-1131, 2, -4203))
        
        if not autoRaceEnabled then break end
        
        print("Waiting 10 seconds...")
        wait(10)
        
        if not autoRaceEnabled then break end
        
        print("Waiting 16.5 seconds...")
        wait(16.5)
        
        if not autoRaceEnabled then break end
        
        for lap = 1, 2 do
            if not autoRaceEnabled then break end
            
            print("Starting lap " .. lap .. " of 2")
            
            for i = 1, #checkpoints do
                if not autoRaceEnabled then
                    break
                end
                
                local checkpoint = checkpoints[i]
                if checkpoint and checkpoint:IsA("BasePart") then
                    print("Lap " .. lap .. " - Teleporting to Checkpoint " .. i)
                    teleportVehicleToCheckpoint(checkpoint.Position)
                    wait(3)
                elseif checkpoint and checkpoint:IsA("Model") then
                    local checkpointPart = checkpoint.PrimaryPart or checkpoint:FindFirstChildWhichIsA("BasePart")
                    if checkpointPart then
                        print("Lap " .. lap .. " - Teleporting to Checkpoint " .. i)
                        teleportVehicleToCheckpoint(checkpointPart.Position)
                        wait(2)
                    end
                end
            end
        end
        
        if autoRaceEnabled then
            print("Both laps complete! Waiting 3 seconds...")
            wait(3)
            print("Restarting cycle...")
        end
    end
end

local AutoRaceToggle = MainTab:CreateToggle({
    Name = "Auto-Race [Around The World]",
    CurrentValue = false,
    Flag = "AutoRaceToggle",
    Callback = function(Value)
        autoRaceEnabled = Value
        
        if Value then
            print("Auto-Race enabled!")
            spawn(function()
                startAutoRace()
            end)
        else
            print("Auto-Race disabled!")
        end
    end,
})

-- ==================== AUTO-BEAMRUSH ====================
local noclipConnection

local function enableNoclip()
    if noclipConnection then return end
    vehicleNoclipEnabled = true
    
    noclipConnection = game:GetService("RunService").Stepped:Connect(function()
        local vehicle = getVehicle()
        if vehicle then
            for _, part in pairs(vehicle:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function disableNoclip()
    vehicleNoclipEnabled = false
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
end

local function startAutoBeamrush()
    print("Auto-Beamrush starting...")
    
    -- Initial teleport
    print("Teleporting to starting position...")
    teleportVehicleToCheckpoint(Vector3.new(-1744, 1, -3739))
    
    if not autoBeamrushEnabled then 
        disableNoclip()
        return 
    end
    
    -- Anchor vehicle during wait
    local vehicle = getVehicle()
    if vehicle then
        for _, part in pairs(vehicle:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Anchored = true
            end
        end
    end
    
    print("Waiting 10 seconds...")
    wait(10)
    
    if not autoBeamrushEnabled then 
        disableNoclip()
        -- Unanchor before stopping
        if vehicle then
            for _, part in pairs(vehicle:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.Anchored = false
                end
            end
        end
        return 
    end
    
    -- Enable noclip (KEEP CAR ANCHORED)
    enableNoclip()
    
    while autoBeamrushEnabled do
        local beamsFolder = workspace:FindFirstChild("Beams")
        
        if not beamsFolder then
            warn("Beams folder not found!")
            -- Car stays anchored
            wait(2)
        else
            local beams = {}
            for _, beam in pairs(beamsFolder:GetChildren()) do
                if beam:IsA("BasePart") then
                    table.insert(beams, beam)
                end
            end
            
            if #beams > 0 then
                print("Found " .. #beams .. " beams! Moving at speed " .. tweenSpeed)
                
                for i, beam in ipairs(beams) do
                    if not autoBeamrushEnabled then
                        print("Auto-Beamrush stopped by user")
                        vehicle = getVehicle()
                        if vehicle then
                            for _, part in pairs(vehicle:GetDescendants()) do
                                if part:IsA("BasePart") then
                                    part.Anchored = false
                                end
                            end
                        end
                        disableNoclip()
                        return
                    end
                    
                    -- Unanchor ONLY RIGHT BEFORE MOVING
                    vehicle = getVehicle()
                    if vehicle then
                        for _, part in pairs(vehicle:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.Anchored = false
                            end
                        end
                    end
                    
                    print("Moving to beam " .. i .. "/" .. #beams .. " (" .. beam.Name .. ")")
                    moveVehicleToPosition(beam.Position, tweenSpeed)
                    
                    -- IMMEDIATELY ANCHOR after reaching beam
                    vehicle = getVehicle()
                    if vehicle then
                        for _, part in pairs(vehicle:GetDescendants()) do
                            if part:IsA("BasePart") then
                                part.Anchored = true
                                part.AssemblyLinearVelocity = Vector3.zero
                                part.AssemblyAngularVelocity = Vector3.zero
                            end
                        end
                    end
                    
                    print("Waiting 3 seconds at beam...")
                    wait(3)
                    
                    -- Car stays anchored for next loop iteration
                end
                
                print("Finished all beams! Checking again in 2 seconds...")
                -- Car stays anchored
                wait(2)
            else
                print("No beams found, waiting...")
                -- Car stays anchored
                wait(2)
            end
        end
    end
    
    -- Unanchor when fully stopped
    vehicle = getVehicle()
    if vehicle then
        for _, part in pairs(vehicle:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Anchored = false
            end
        end
    end
    
    disableNoclip()
    print("Auto-Beamrush stopped")
end

local AutoBeamrushToggle = MainTab:CreateToggle({
    Name = "Auto-Beamrush [GLITCHY]",
    CurrentValue = false,
    Flag = "AutoBeamrushToggle",
    Callback = function(Value)
        autoBeamrushEnabled = Value
        
        if Value then
            print("Auto-Beamrush enabled!")
            spawn(function()
                startAutoBeamrush()
            end)
        else
            print("Auto-Beamrush disabled!")
            disableNoclip()
        end
    end,
})

local TweenSpeedSlider = MainTab:CreateSlider({
    Name = "Beamrush Speed",
    Range = {10, 500},
    Increment = 10,
    CurrentValue = 100,
    Flag = "TweenSpeedSlider",
    Callback = function(Value)
        tweenSpeed = Value
        print("Speed set to: " .. Value)
    end,
})

MainTab:CreateLabel("Get in your car first.")

-- ==================== AUTO-DELIVERY ====================
local autoDeliveryEnabled = false

local function startAutoDelivery()
    print("Auto-Delivery starting...")
    
    while autoDeliveryEnabled do
        -- Step 1: Teleport to NPC location
        print("Teleporting to NPC location...")
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
        humanoidRootPart.CFrame = CFrame.new(-1750, 3, -4625)
        
        wait(1)
        
        -- Step 2: Lock camera to NPC
        print("Locking camera to NPC...")
        local camera = workspace.CurrentCamera
        local npc = workspace:WaitForChild("CarQuestFolder"):WaitForChild("NPC")
        camera.CameraSubject = npc
        camera.CameraType = Enum.CameraType.Watch
        
        wait(0.5)
        
        -- Step 3: Press E
        print("Pressing E...")
        local VIM = game:GetService("VirtualInputManager")
        VIM:SendKeyEvent(true, Enum.KeyCode.E, false, game)
        wait(0.1)
        VIM:SendKeyEvent(false, Enum.KeyCode.E, false, game)
        
        wait(2)
        
        -- Step 4: Find and select a car that starts with "20"
        print("Looking for car starting with '20'...")
        local playerGui = game:GetService("Players").LocalPlayer.PlayerGui
        local deliveryGui = playerGui:WaitForChild("MiniGames"):WaitForChild("Delivery")
        local scrollingFrame = deliveryGui:WaitForChild("Frames"):WaitForChild("Orders"):WaitForChild("Orders"):WaitForChild("ScrollingFrame")
        
        local carFound = false
        for _, frame in pairs(scrollingFrame:GetChildren()) do
            if frame:IsA("Frame") and frame.Name:match("^20") then
                local textButton = frame:FindFirstChild("TextButton")
                if textButton then
                    print("Found car: " .. frame.Name)
                    
                    -- Navigate to the button using GuiService
                    local GuiService = game:GetService("GuiService")
                    GuiService.SelectedObject = textButton
                    
                    wait(0.5)
                    
                    -- Press Enter to select
                    print("Pressing Enter to select car...")
                    VIM:SendKeyEvent(true, Enum.KeyCode.Return, false, game)
                    wait(0.1)
                    VIM:SendKeyEvent(false, Enum.KeyCode.Return, false, game)
                    
                    carFound = true
                    break
                end
            end
        end
        
        if not carFound then
            warn("No car starting with '20' found!")
            -- Reset camera
            camera.CameraSubject = character:FindFirstChildOfClass("Humanoid")
            camera.CameraType = Enum.CameraType.Custom
            wait(2)
        else
            -- Step 5: Wait 15 seconds
            print("Waiting 15 seconds...")
            wait(15)
            
            -- Reset camera
            camera.CameraSubject = character:FindFirstChildOfClass("Humanoid")
            camera.CameraType = Enum.CameraType.Custom
            
            if not autoDeliveryEnabled then
                print("Auto-Delivery stopped by user")
                return
            end
            
            -- Continue with the rest of Auto-Delivery
            local carQuestFolder = workspace:FindFirstChild("CarQuestFolder")
            
            if not carQuestFolder then
                warn("CarQuestFolder not found!")
                wait(2)
            else
                -- Find the car model (ignore NPC and SkyBeam)
                local carModel = nil
                for _, child in pairs(carQuestFolder:GetChildren()) do
                    if child:IsA("Model") and child.Name ~= "NPC" and child.Name ~= "SkyBeam" and child.Name ~= "Areas" then
                        carModel = child
                        break
                    end
                end
                
                if not carModel then
                    warn("No car model found in CarQuestFolder!")
                    wait(2)
                else
                    -- Find the DriverSeat
                    local driverSeat = carModel:FindFirstChild("DriveSeat")
                    
                    if not driverSeat then
                        warn("DriveSeat not found in car model!")
                        wait(2)
                    else
                        print("Found car: " .. carModel.Name)
                        print("Teleporting to DriverSeat...")
                        
                        -- Teleport player to DriverSeat
                        humanoidRootPart.CFrame = driverSeat.CFrame
                        
                        wait(1)
                        
                        -- Press F
                        print("Pressing F to enter car...")
                        VIM:SendKeyEvent(true, Enum.KeyCode.F, false, game)
                        wait(0.1)
                        VIM:SendKeyEvent(false, Enum.KeyCode.F, false, game)
                        
                        wait(1)
                        
                        -- Now find delivery areas
                        local areasFolder = carQuestFolder:FindFirstChild("Areas")
                        
                        if not areasFolder then
                            warn("Areas folder not found!")
                            wait(2)
                        else
                            -- Get all DeliveryArea models
                            local allDeliveryAreas = {}
                            for _, area in pairs(areasFolder:GetChildren()) do
                                if area.Name:match("DeliveryArea") and area:IsA("Model") then
                                    table.insert(allDeliveryAreas, area)
                                end
                            end
                            
                            if #allDeliveryAreas == 0 then
                                warn("No delivery areas found!")
                                wait(2)
                            else
                                -- Filter to only areas with transparency 0
                                local activeDeliveryAreas = {}
                                for _, area in pairs(allDeliveryAreas) do
                                    local neonFolder = area:FindFirstChild("Neon")
                                    if neonFolder then
                                        local neonParts = neonFolder:GetChildren()
                                        if neonParts[3] and neonParts[3]:IsA("BasePart") then
                                            if neonParts[3].Transparency == 0 then
                                                table.insert(activeDeliveryAreas, area)
                                            end
                                        end
                                    end
                                end
                                
                                if #activeDeliveryAreas == 0 then
                                    warn("No active delivery areas (transparency 0) found!")
                                    wait(2)
                                else
                                    print("Found " .. #activeDeliveryAreas .. " active delivery areas!")
                                    
                                    -- Go to the FIRST active delivery area only
                                    local area = activeDeliveryAreas[1]
                                    
                                    if not autoDeliveryEnabled then
                                        print("Auto-Delivery stopped by user")
                                        return
                                    end
                                    
                                    -- Find a part in the model to teleport to
                                    local areaPart = area.PrimaryPart or area:FindFirstChildWhichIsA("BasePart")
                                    
                                    if not areaPart then
                                        warn("No part found in delivery area " .. area.Name)
                                        wait(2)
                                    else
                                        print("Teleporting to delivery area: " .. area.Name)
                                        
                                        -- Teleport (teleportVehicleToCheckpoint already freezes and unfreezes)
                                        teleportVehicleToCheckpoint(areaPart.Position)
                                        
                                        -- Freeze the car for 3 seconds
                                        local vehicle = getVehicle()
                                        if vehicle then
                                            for _, part in pairs(vehicle:GetDescendants()) do
                                                if part:IsA("BasePart") then
                                                    part.Anchored = true
                                                end
                                            end
                                        end
                                        
                                        print("Car frozen for 1.5 seconds...")
                                        wait(1.5)
                                        
                                        -- Unfreeze the car
                                        if vehicle then
                                            for _, part in pairs(vehicle:GetDescendants()) do
                                                if part:IsA("BasePart") then
                                                    part.Anchored = false
                                                end
                                            end
                                        end
                                        
                                        print("Car unfrozen, waiting 5 seconds at delivery area...")
                                        wait(5)
                                        
                                        print("Waiting 1 seconds before going back to NPC...")
                                        wait(1)
                                        
                                        print("Delivery completed! Going back to NPC...")
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end
        
        if not autoDeliveryEnabled then
            break
        end
        
        print("Restarting Auto-Delivery cycle...")
        wait(2)
    end
    
    print("Auto-Delivery stopped")
end

local AutoDeliveryToggle = MainTab:CreateToggle({
    Name = "Auto-Delivery",
    CurrentValue = false,
    Flag = "AutoDeliveryToggle",
    Callback = function(Value)
        autoDeliveryEnabled = Value
        
        if Value then
            print("Auto-Delivery enabled!")
            spawn(function()
                startAutoDelivery()
            end)
        else
            print("Auto-Delivery disabled!")
        end
    end,
})

-- ==================== AUTO-PRESENT ====================
local presentLocations = {
    Vector3.new(-2078, 150, -4495),
    Vector3.new(-1888, 150, -3480),
    Vector3.new(-1054, 150, -4671),
    Vector3.new(-1143, 150, -3068),
    Vector3.new(-205, 150, -4506),
    Vector3.new(1145, 150, -4357),
    Vector3.new(22, 150, -3487),
    Vector3.new(-1025, 150, -2568),
    Vector3.new(417, 150, -2308),
    Vector3.new(-1078, 150, -1307),
    Vector3.new(-523, 150, -574),
    Vector3.new(713, 150, -562),
    Vector3.new(1346, 150, -1452),
    Vector3.new(1636, 150, -3026),
    Vector3.new(2560, 150, -3963),
    Vector3.new(2283, 150, -2892),
    Vector3.new(2055, 150, -1642),
    Vector3.new(2069, 150, -488),
    Vector3.new(3840, 150, -1101),
    Vector3.new(4045, 150, -2016),
    Vector3.new(2810, 150, -2333),
    Vector3.new(3989, 150, -2851),
    Vector3.new(3502, 150, -3850),
    Vector3.new(4344, 150, -4923),
    Vector3.new(2916, 150, -5053),
    Vector3.new(-1028, 150, -503),
    Vector3.new(2398, 150, 2112),
    Vector3.new(5949, 150, 2772),
    Vector3.new(3530, 150, 37),
    Vector3.new(2942, 150, -1515),
    Vector3.new(-1180, 150, -3275)
}

local function teleportPlayer(position)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    
    humanoidRootPart.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
    humanoidRootPart.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
    humanoidRootPart.CFrame = CFrame.new(position)
end

local function freezePlayer(freeze)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    humanoidRootPart.Anchored = freeze
end

local function getAllPresents()
    local presents = {}
    
    local pumpkinsFolder = workspace:FindFirstChild("Pumpkins")
    local goldenPumpkinsFolder = workspace:FindFirstChild("PumpkinsGolden")
    
    if pumpkinsFolder then
        for _, model in pairs(pumpkinsFolder:GetChildren()) do
            if model:IsA("Model") then
                table.insert(presents, model)
            end
        end
    end
    
    if goldenPumpkinsFolder then
        for _, model in pairs(goldenPumpkinsFolder:GetChildren()) do
            if model:IsA("Model") then
                table.insert(presents, model)
            end
        end
    end
    
    return presents
end

local function startAutoPresent()
    local collectedPresents = {}
    
    while autoPresentEnabled do
        print("=== Starting new cycle ===")
        
        for i, location in ipairs(presentLocations) do
            if not autoPresentEnabled then 
                freezePlayer(false)
                print("Auto-Present stopped by user")
                return 
            end
            
            print("Checking location " .. i .. " of " .. #presentLocations)
            
            teleportPlayer(location)
            freezePlayer(true)
            wait(2)
            
            local allPresents = getAllPresents()
            local nearbyPresents = {}
            
            for _, present in pairs(allPresents) do
                if not collectedPresents[present] then
                    local presentPart = present.PrimaryPart or present:FindFirstChildWhichIsA("BasePart")
                    if presentPart then
                        local distance = (presentPart.Position - location).Magnitude
                        if distance <= 3000 then
                            table.insert(nearbyPresents, present)
                        end
                    end
                end
            end
            
            freezePlayer(false)
            
            if #nearbyPresents > 0 then
                print("Found " .. #nearbyPresents .. " presents near location " .. i .. "! Collecting...")
                
                for _, present in pairs(nearbyPresents) do
                    if not autoPresentEnabled then 
                        return 
                    end
                    
                    local presentPart = present.PrimaryPart or present:FindFirstChildWhichIsA("BasePart")
                    if presentPart then
                        print("Teleporting to collect present: " .. present.Name)
                        teleportPlayer(presentPart.Position)
                        collectedPresents[present] = true
                        wait(0.5)
                    end
                end
                
                print("Finished collecting presents at location " .. i)
            else
                print("No presents near location " .. i)
            end
            
            wait(0.2)
        end
        
        print("=== Completed all " .. #presentLocations .. " locations! ===")
        print("Clearing collected presents list and restarting cycle in 1 second...")
        collectedPresents = {}
        wait(1)
    end
    
    freezePlayer(false)
    print("Auto-Present fully stopped")
end

local AutoPresentToggle = MainTab:CreateToggle({
    Name = "Auto-Present",
    CurrentValue = false,
    Flag = "AutoPresentToggle",
    Callback = function(Value)
        autoPresentEnabled = Value
        
        if Value then
            print("Auto-Present enabled!")
            spawn(function()
                startAutoPresent()
            end)
        else
            print("Auto-Present disabled!")
        end
    end,
})

Rayfield:LoadConfiguration()
